# Settings in the [build] context are global and are applied to all contexts
# unless otherwise overridden by more specific contexts.
[build]
  # Directory to change to before starting a build.
  # This is where we will look for package.json/.nvmrc/etc.
  base = "/"

  # Directory (relative to root of your repo) that contains the deploy-ready
  # HTML files and assets generated by the build. If a base directory has
  # been specified, include it in the publish directory path.
  publish = "dist"

  # Default build command.
  command = "npm run build-for-netlify"

  # Directory with the serverless Lambda functions to deploy to AWS.
#   functions = "project/functions/"

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

# Need this for the environment part to work

# Production context: all deploys from the Production branch set in your site's
# deploy contexts will inherit these settings.
[context.production]
[context.production.environment]
  CONTENTFUL_ENV = "master"

  OKTA_BASE_URL = "https://crossroads.okta.com"
  OKTA_REDIRECT_URI = "https://www.crossroads.net/oktasignin"
  # OKTA_FACEBOOK_CLIENT_ID = ""
  # OKTA_GOOGLE_CLIENT_ID = ""

  CRDS_COOKIE_PREFIX = ""
  CRDS_GATEWAY_ENDPOINT = "https://gateway.crossroads.net/gateway/api/image/profile/"
  CRDS_APP_ENDPOINT = "https://www.crossroads.net/"
  CRDS_CMS_ENDPOINT = "https://content.crossroads.net/"


# Specific branch context: all deploys from this specific branch will inherit
# these settings.

[context.release]
[context.release.environment] # 'release' is a branch name
  CONTENTFUL_ENV = "demo"

  OKTA_BASE_URL = "https://authpreview.crossroads.net"
  OKTA_REDIRECT_URI = "https://demo.crossroads.net/oktasignin"
  # OKTA_FACEBOOK_CLIENT_ID = ""
  # OKTA_GOOGLE_CLIENT_ID = ""

  CRDS_COOKIE_PREFIX = "demo"
  CRDS_GATEWAY_ENDPOINT = "https://gatewaydemo.crossroads.net/gateway/api/image/profile/"
  CRDS_APP_ENDPOINT = "https://demo.crossroads.net/"
  CRDS_CMS_ENDPOINT = "https://contentdemo.crossroads.net/"

[context.development]
[context.development.environment] # 'development' is a branch name
  CONTENTFUL_ENV = "int"

  OKTA_BASE_URL = "https://authpreview.crossroads.net"
  OKTA_REDIRECT_URI = "https://int.crossroads.net/oktasignin"
  # OKTA_FACEBOOK_CLIENT_ID = ""
  # OKTA_GOOGLE_CLIENT_ID = ""

  CRDS_COOKIE_PREFIX = "int"
  CRDS_GATEWAY_ENDPOINT = "https://gatewayint.crossroads.net/gateway/api/image/profile/"
  CRDS_APP_ENDPOINT = "https://int.crossroads.net/"
  CRDS_CMS_ENDPOINT = "https://contentint.crossroads.net/"

[context.branch-deploy]
[context.branch-deploy.environment]
  CONTENTFUL_ENV = "int"

  OKTA_BASE_URL = "https://authpreview.crossroads.net"
  OKTA_REDIRECT_URI = "https://int.crossroads.net/oktasignin"
  # OKTA_FACEBOOK_CLIENT_ID = ""
  # OKTA_GOOGLE_CLIENT_ID = ""

  CRDS_COOKIE_PREFIX = "int"
  CRDS_GATEWAY_ENDPOINT = "https://gatewayint.crossroads.net/gateway/api/image/profile/"
  CRDS_APP_ENDPOINT = "https://int.crossroads.net/"
  CRDS_CMS_ENDPOINT = "https://contentint.crossroads.net/"

  TEAMCITY_TEST_BUILD = "WebApps_SignInPage_2Development"

[context.deploy-preview]
[context.deploy-preview.environment]
  CONTENTFUL_ENV = "int"

  OKTA_BASE_URL = "https://authpreview.crossroads.net"
  OKTA_REDIRECT_URI = "https://int.crossroads.net/oktasignin"
  # OKTA_FACEBOOK_CLIENT_ID = ""
  # OKTA_GOOGLE_CLIENT_ID = ""

  CRDS_COOKIE_PREFIX = "int"
  CRDS_GATEWAY_ENDPOINT = "https://gatewayint.crossroads.net/gateway/api/image/profile/"
  CRDS_APP_ENDPOINT = "https://int.crossroads.net/"
  CRDS_CMS_ENDPOINT = "https://contentint.crossroads.net/"

  TEAMCITY_TEST_BUILD = "WebApps_SignInPage_2Development" # TODO remove this, only for testing - only want to run these on branch deploys for now

[[headers]]
  for = "/*.woff"
  [headers.values]
    Access-Control-Allow-Origin = "*"
    Content-Type = "application/font-woff"